### ============================================
### FASE 6 - CHECKOUT & ORDERS - TESTES
### ============================================

@baseUrl = http://localhost:3000/api/v1
@token = YOUR_AUTH_TOKEN_HERE

### ============================================
### 1. SHIPPING - Métodos de Envio
### ============================================

### 1.1. Listar métodos de envio disponíveis
GET {{baseUrl}}/shipping/methods

### 1.2. Calcular frete
POST {{baseUrl}}/shipping/calculate
Content-Type: application/json

{
  "items": [
    {
      "productId": "PRODUCT_ID_HERE",
      "quantity": 2
    }
  ],
  "zipCode": "01310-100",
  "cartTotal": 250.00
}

### ============================================
### 2. ORDERS - Pedidos (Requer autenticação)
### ============================================

### 2.1. Criar pedido
POST {{baseUrl}}/orders
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "addressId": "ADDRESS_ID_HERE",
  "items": [
    {
      "productId": "PRODUCT_ID_HERE",
      "quantity": 1,
      "size": "M"
    }
  ],
  "shippingMethodId": "SHIPPING_METHOD_ID_HERE",
  "couponCode": "BEMVINDO10",
  "paymentMethod": "credit_card",
  "notes": "Entregar no portão"
}

### 2.2. Listar meus pedidos
GET {{baseUrl}}/orders
Authorization: Bearer {{token}}

### 2.3. Buscar pedido específico
GET {{baseUrl}}/orders/ORDER_ID_HERE
Authorization: Bearer {{token}}

### 2.4. Cancelar pedido
POST {{baseUrl}}/orders/ORDER_ID_HERE/cancel
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "reason": "Desisti da compra, encontrei produto melhor"
}

### ============================================
### FLUXO COMPLETO DE TESTE
### ============================================

### PASSO 1: Login
# @name login
POST {{baseUrl}}/auth/login
Content-Type: application/json

{
  "email": "cliente@example.com",
  "password": "senha123"
}

### PASSO 2: Listar produtos para pegar IDs
# @name products
GET {{baseUrl}}/products

### PASSO 3: Listar métodos de envio
# @name shippingMethods
GET {{baseUrl}}/shipping/methods

### PASSO 4: Calcular frete
# Use os IDs dos produtos do PASSO 2
POST {{baseUrl}}/shipping/calculate
Content-Type: application/json

{
  "items": [
    {
      "productId": "REPLACE_WITH_PRODUCT_ID",
      "quantity": 1
    }
  ],
  "zipCode": "01310-100",
  "cartTotal": 150.00
}

### PASSO 5: Criar endereço (se não tiver)
# Use o token do PASSO 1
POST {{baseUrl}}/users/me/addresses
Authorization: Bearer REPLACE_WITH_TOKEN
Content-Type: application/json

{
  "street": "Av. Paulista",
  "number": "1000",
  "complement": "Apto 101",
  "neighborhood": "Bela Vista",
  "city": "São Paulo",
  "state": "SP",
  "zipCode": "01310-100",
  "receiverName": "João Silva",
  "receiverPhone": "11988888888",
  "isDefault": true
}

### PASSO 6: Criar pedido completo
# Use o token do PASSO 1
# Use productId do PASSO 2
# Use shippingMethodId do PASSO 3
# Use addressId do PASSO 5 (ou do seed)
POST {{baseUrl}}/orders
Authorization: Bearer REPLACE_WITH_TOKEN
Content-Type: application/json

{
  "addressId": "REPLACE_WITH_ADDRESS_ID",
  "items": [
    {
      "productId": "REPLACE_WITH_PRODUCT_ID",
      "quantity": 1,
      "size": "M"
    }
  ],
  "shippingMethodId": "REPLACE_WITH_SHIPPING_METHOD_ID",
  "couponCode": "BEMVINDO10",
  "paymentMethod": "pix"
}

### PASSO 7: Listar meus pedidos
GET {{baseUrl}}/orders
Authorization: Bearer REPLACE_WITH_TOKEN

### PASSO 8: Ver detalhes do pedido
GET {{baseUrl}}/orders/REPLACE_WITH_ORDER_ID
Authorization: Bearer REPLACE_WITH_TOKEN
